<div class="text-input">
	<textarea spellcheck="false" aria-label="math formula input"></textarea>
</div>

<div class="dragger"></div>

<section class="html-output" aria-label="live preview of mathematical document">
	<div class="end-element"></div>
</section>

<style>
	@layer elements {
		:host {
			block-size: 100%;
			display: flex;
			box-sizing: border-box;
			background-color: var(--gray-1);
			--dragger-width: 10px;
			--split-proportion: .5;
			--full-length: 100cqi;
			--dragger-cursor: ew-resize;
			container-type: size;
		}

		@media (hover: none) {
			:host {
				--dragger-width: 16px;
			}
		}

		:root[data-editor-layout="stacked"] :host {
			flex-direction: column;
			--dragger-cursor: ns-resize;
			--full-length: 100cqb;
		}

		:host.dragging {
			cursor: var(--dragger-cursor);
			-webkit-user-select: none;
			user-select: none;
		}

		:root[data-editor-layout="aside"] :host .text-input {
			border-start-end-radius: .3rem;
		}
		
		:root[data-editor-layout="aside"] :host .html-output {
			border-start-start-radius: .3rem;
		}
		
		:root[data-transition="toggling-layout"] :host .text-input {
			view-transition-name: text-input;
		}
		
		:root[data-transition="toggling-layout"] :host .html-output {
			view-transition-name: html-output;
		}

		.text-input {
			flex-grow: 0;
			flex-shrink: 0;
			--clamped-split-proportion: clamp(0, var(--split-proportion), 1);
			flex-basis: calc(var(--clamped-split-proportion) * (var(--full-length) - var(--dragger-width)));
			font-family: ui-monospace, monospace;
			font-size: 1.1rem;
			background-color: var(--background);
			overflow: hidden;
			contain: layout;
			/* view-transition-name: text-input; */
		}

		.text-input textarea {
			padding: .8rem 1rem;
			resize: none;
			inline-size: 100%;
			block-size: 100%;
			box-sizing: border-box;
			outline: none;
			overflow: auto;
			min-block-size: 0;
		}

		.dragger {
			flex-shrink: 0;
			flex-basis: var(--dragger-width);
			cursor: var(--dragger-cursor);
			display: flex;
			gap: 2px;
			align-items: center;
			justify-content: center;
			transition: background-color .2s;
		}

		:root[data-editor-layout="stacked"] :host .dragger {
			flex-direction: column;
		}

		.dragger:hover {
			background-color: var(--gray-2);
		}

		.dragger::before, .dragger::after {
			content: "";
			--width: 2px;
			--length: 1rem;
			inline-size: var(--width);
			block-size: var(--length);
			border-radius: 1px;
			background-color: var(--color);
			opacity: .5;
		}

		:root[data-editor-layout="stacked"] :host .dragger::before, :root[data-editor-layout="stacked"] :host .dragger::after {
			inline-size: var(--length);
			block-size: var(--width);
		}

		:root[data-editor-layout="aside"] :host .dragger {
			border-start-start-radius: .15rem;
			border-start-end-radius: .15rem;
		}

		.html-output {
			flex-grow: 1;
			flex-shrink: 1;
			flex-basis: 0;
			font-family: "Computer Modern Serif", "Noto Serif", ui-serif, serif;
			padding: 1rem;
			padding-block-start: 0;
			background-color: var(--background);
			/* overflow-y: auto; */
			overflow: auto;
			overflow-wrap: break-word;
			font-size: 1.1rem;
			line-height: 1.5rem;
			contain: layout;
			/* view-transition-name: html-output; */
		}

		.html-output .section {
			content-visibility: auto;
			contain-intrinsic-block-size: auto 10rem;
		}

		.html-output code {
			white-space: pre-wrap;
			font-family: "FreeMono", "Courier New", ui-monospace, monospace;
			padding-inline: .2em;
			background-color: var(--gray-1);
			font-size: .9rem;
		}

		:root[data-engine=blink] :host .html-output .integral {
			/* font-size: 1.5em; */
		}

		:root[data-engine=blink] :host .html-output :is(msqrt > *, mroot > :first-child) {
			translate: 0 calc(2 * 1em / 16);
		}

		:root[data-engine=blink] :host .html-output mfrac > * {
			translate: 0 calc(1 * 1em / 16);
			/* translate: 0 .2em; */
			/* translate: 0 2px; */
		}

		math {
			/* margin-block: .2em; */
		}

		math[display=block] {
			margin-block: .5em;
		}

		:is(h1, h2, h3, h4, h5, h6) {
			margin-block: .8em .5em;
		}

		p.bottom-margin {
			margin-block-end: .7em;
		}

		:is(p, h1, h2, h3, h4, h5, h6) {
			white-space: pre-wrap;
		}

		@media print {
			:host {
				display: block;
				container-type: normal;
			}

			.dragger, .text-input {
				display: none;
			}

			.html-output {
				overflow: unset;
				padding: 0;
			}
		}
	}
</style>